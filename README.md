# Leaf shape analysis using Procrustes analysis and pseudo-landmarks to process any leaf shape
This repisotory includes the necessary tools for assigning pseudo-landmarks to any leaf. Then, pseudo-landmarks are used to calculate a procrues distance by rotating, scaling, and aligning all leaves. 
The dataset present in this repository includes leaves from eight different research groups and of various shapes. Using the leaf shape analysis jupyter notebook (GPA_leaf_shape_v1.ipynb), we combined each species dataset into one overall dataset and created a dataset morphospace that used PC's to describe the shape of all leaves present (Fig. 1). We then colored the PCA morphospace using shape descriptors (Fig. 2). Finally, we used LDA to predict differences in leaf shape using combinations of pseudo-landmarks (Fig. 3). Using previously published leaf shapes, we also show how to process and analyze continuous representations of leaf shapes (passiflora.ipynb) and to determing the underlying genetic architecture that controls and affects leaf shape (tomato_leaflet_genetics.ipynb). 

![figure_morphospace_figure](https://github.com/user-attachments/assets/464b9680-deab-4775-8d99-b169c40b29d4)
Figure 1. **Morphospace of theoretical leaves recreated from the inverse of PC1 and PC2.** Four quadrants are defined left to right (width of leaves)  and top to bottom (petiole definition, amount of lamina). 

![combined_expanded_dataset_061125](https://github.com/user-attachments/assets/f5f098c1-3637-42cb-b4c9-ebff053b6ede)
Figure 2. **Morphospace PCA of all leaves.** The projected morphospace includes eigenleaves created by taking the inverse of the PCA. These eigenleaves were created from the 100 pseudo-landmarks outlining each leaf image. 

![lda_dataset_scatter_061125](https://github.com/user-attachments/assets/bc632fd7-6025-4f11-9b37-0af1224b6ca4)
Figure 3. **Linear discriminant analysis of all leaves.** A. A confusion matrix of actual and predicted leaves from each species dataset based on the 100-pseudo landmarks.

## A call to action: building a morphospace of all leaf shapes
In the study we performed to test and describe our leaf shape analysis, we have shown that examining leaf shape variation can be easy, cheap, and fast. Importantly, by using base and tip points that are common and homologous to all leaves and placing equidistantly spaced pseudo-landmarks on each side of the leaf, any leaf can compared in overall similarity to any other. Therefore, as we continue to study leaf shape as a wider plant science community, we would like to challenge any researchers that are interested in leaf shape to not only use the analyses and data presented in their study with these analyses techniques, but to combine your data with the leaf shapes shared here to create a continuously growing morphospace of all leaves. 

Our goal is to continuously update the proc_arr array which contains the leaf information and Procrustes aligned pseudo-landmarks to create a PCA morphospace of all the worlds leaves. Therefore, if you use our leaf shape analysis to analyze any leaves, please send your proc_arr array (or leaf data in any other form) to **Asia Hightower (asiac313@gmail.com)**. After recieving leaf data, we will update the proc_arr array in this repository and repost an updated PCa morphospace that includes all leaves possible. The ultimate goal is that any future leaf shape research can feature this all leaves morphospace and each study can highlight the relationships between their leaves and all other leaves. 
